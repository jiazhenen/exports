<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.itcast.dao.stat.StatDao" >


    <select id="factoryCharts" parameterType="string" resultType="map">
        select factory_name as name , sum(amount) as value
        from co_contract_product where company_id=#{companyId} GROUP BY factory_name
    </select>

    <select id="sellCharts" parameterType="string" resultType="map">
     select product_no as name,sum(cnumber) as value from co_contract_product
     where company_id=#{companyId}   GROUP BY product_no order by value desc limit 15
    </select>

    <select id="onlineCharts" parameterType="string" resultType="map">
    select  soi.A1 as name, IFNULL(t.total,0) as value from st_online_info soi LEFT JOIN
(select DATE_FORMAT(time,'%H') as hours ,count(0) total from st_sys_log where company_id=#{companyId} GROUP BY  DATE_FORMAT(time,'%H')) t
on soi.A1=t.hours
    </select>

    <select id="product"  resultType="map">
        select hwname as name , jiage as `value` from test order by `value` desc limit 10

        select cep.`product_no` AS NAME, cep.`price` AS VALUE  from `co_product` cp right join
co_export_product cep on cp.factoryId = cep.factory_id group by name order by value desc limit 10
    </select>
    <select id="caozuo" parameterType="string" resultType="map">
        SELECT ip AS `name`, COUNT(ip) AS `value`
 FROM st_sys_log WHERE company_id =1 GROUP BY  ip ORDER BY `value` DESC LIMIT 10
    </select>

</mapper>